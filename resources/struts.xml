<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE struts PUBLIC
    "-//Apache Software Foundation//DTD Struts Configuration 2.0//EN"
    "http://struts.apache.org/dtds/struts-2.0.dtd">

<struts>
	<constant name="struts.custom.i18n.resources" value="global" />
	<constant name="struts.devMode" value="true" />	
	
	
	<!-- You can define packages directly in this file, but its probably best 
		to modularize the configuration files with separate xml files for each package. 
		Ulitmately its all the same because the include element, seen below, pulls 
		the included configuration document directly in to the primary document. 
		The only thing to consider is that a referenced element must have been declared 
		above the referring element. -->

	<!-- This is the menu action that will allow the reader to see the different 
		samples actions from the different chapters in a menu format. We declare 
		it here, in the root namespace, because its not really related to any of 
		the specific examples or chapters, its just a kind of utility for the whole 
		application. -->
		
		
	
	<package name="visitor" namespace="/" extends="struts-default">
		<action name="welcome">
			<result>/jsp/welcome.jsp</result>
		</action>
		<action name="registerPage">
			<result>/jsp/register.jsp</result>
		</action>		
		<action name="login" class="com.th5.struts.actions.LoginAction">
			<result name="success">/jsp/welcome.jsp</result>
			<result name="error">/jsp/welcome.jsp</result>
			<result name="input">/jsp/welcome.jsp</result>
		</action>
		<action name="register" class="com.th5.struts.actions.RegisterAction">
			<result name="success">/jsp/registerSuccess.jsp</result>
			<result name="error">/jsp/register.jsp</result>
			<result name="input">/jsp/register.jsp</result>
		</action>
		<action name="registerForm">
			<result name="success">/jsp/register.jsp</result>
		</action>
		<action name="allAuctions" class="com.th5.struts.actions.AllAuctionsAction">
			<result name="success">/jsp/auctions.jsp</result>
		</action>
	</package>
	
	<package name="member" namespace="/member" extends="struts-default">
		<interceptors>
			<interceptor name="authenticationInterceptor"
				class="com.th5.struts.interceptors.AuthenticationInterceptor" />

			<interceptor-stack name="MemberStack">
				<interceptor-ref name="authenticationInterceptor" />
				<interceptor-ref name="defaultStack" />
			</interceptor-stack>
		</interceptors>
	
		<default-interceptor-ref name="MemberStack" />	
		
		<global-results>
			<result name="login" type="redirect">
				/jsp/notLoggedIn.jsp
			</result>
		</global-results>
		
		<action name="logout" class="com.th5.struts.actions.LogoutAction">
			<result name="success">/jsp/welcome.jsp</result>
		</action>
		
		<action name="buyBidCoinsForm">
			<result>/jsp/members/addBidCoins.jsp</result>
		</action>
		
		<action name="buyBidCoins" class="com.th5.struts.actions.BuyBidCoinsAction">
			<result>/jsp/welcome.jsp</result>
		</action>
		
		<action name="editProfileForm">
			<result>/jsp/members/editProfile.jsp</result>
		</action>
		
		<action name="editProfile" class="com.th5.struts.actions.EditProfileAction">
			<result name="success">/jsp/welcome.jsp</result>
			<result name="input">/jsp/members/editProfile.jsp</result>
		</action>
		
		<action name="addAuctionForm" class="com.th5.struts.actions.AddAuctionFormAction">
			<result name="success">/jsp/members/addAuction.jsp</result>
		</action>
		
		<action name="addAuction" class="com.th5.struts.actions.AddAuctionAction">
			<result name="success">/jsp/members/addAuctionResult.jsp</result>
			<result name="input">/jsp/members/addAuction.jsp</result>
		</action>
				
		<action name="fileUploadAction" class="com.th5.struts.others.FileUploadAction" method="display">
			<result name="none">/jsp/members/addAuction.jsp</result>
		</action>
		
		<action name="resultAction" class="com.th5.struts.others.FileUploadAction">
			<interceptor-ref name="exception"/>
            <interceptor-ref name="i18n"/>
            <interceptor-ref name="fileUpload">
       			<param name="allowedTypes">image/jpeg,image/jpg</param>
       			<param name="maximumSize">5242880</param>
  			</interceptor-ref> 
            <interceptor-ref name="params">
                <param name="excludeParams">dojo\..*,^struts\..*</param>
            </interceptor-ref>
            <interceptor-ref name="validation">
                <param name="excludeMethods">input,back,cancel,browse</param>
            </interceptor-ref>
            <interceptor-ref name="workflow">
                <param name="excludeMethods">input,back,cancel,browse</param>
            </interceptor-ref>
    
			<result name="success" type="chain">addAuction</result>
			<result name="input">/jsp/members/addAuction.jsp</result>
			
		</action>
		
	</package>

	<!--include file="manning/chapterTwo/chapterTwo.xml"/-->

</struts>
